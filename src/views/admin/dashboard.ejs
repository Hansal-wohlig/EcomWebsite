<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/header', { title }) %>
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
  <div class="admin-container">
    <h1>Admin Dashboard</h1>

    <!-- Tabs -->
    <div class="tabs">
      <button onclick="showTab('products')">Products</button>
      <button onclick="showTab('categories')">Categories</button>
    </div>

    <!-- Products Tab -->
    <div id="products" class="tab section-form">
      <h2>Add Product</h2>
      <form action="/admin/products" method="POST" enctype="multipart/form-data">
        <input type="text" name="title" placeholder="Title" required>
        <textarea name="description" placeholder="Description"></textarea>
        <input type="number" name="price" placeholder="Price" required>
        <input type="number" name="stockQty" placeholder="Stock Quantity" required>
        <select name="category" required>
          <% categories.forEach(cat => { %>
            <option value="<%= cat._id %>"><%= cat.name %></option>
          <% }) %>
        </select>
        <input type="file" name="images" multiple>
        <input type="submit" value="Add Product">
      </form>

      <h2>All Products</h2>
      <% products.forEach(prod => { %>
        <div class="item">
          <span><strong><%= prod.title %></strong> â€“ <%= prod.category?.name %></span>
          <form action="/admin/products/delete/<%= prod._id %>" method="POST">
            <button type="submit">Delete</button>
          </form>
        </div>
      <% }) %>
    </div>

    <!-- Categories Tab -->
    <div id="categories" class="tab section-form" style="display:none;">
      <h2>Add Category</h2>
      <form action="/admin/categories" method="POST">
        <input type="text" name="name" placeholder="Category name" required>
        <input type="submit" value="Add Category">
      </form>

      <h2>All Categories</h2>
      <% categories.forEach(cat => { %>
        <div class="item">
          <span><%= cat.name %></span>
          <form action="/admin/categories/delete/<%= cat._id %>" method="POST">
            <button type="submit">Delete</button>
          </form>
        </div>
      <% }) %>
    </div>
  </div>

  <!-- JS for Tab Switching -->
  <script>
    function showTab(tab) {
      document.getElementById('products').style.display = tab === 'products' ? 'block' : 'none';
      document.getElementById('categories').style.display = tab === 'categories' ? 'block' : 'none';
    }
  </script>
</body>
</html>
